:root{
  --screen-width: 1280px;
  --screen-height: 720px;
  --transition-duration: 400ms;
  --bv-body-fade-in: 600ms;
  --bv-body-fade-out: 400ms;
  --bv-opacity-start: 0;
  --bv-opacity-end: 1;
  --btn-next-left: 1015px;
  --btn-next-top: 600px;
  --btn-restart-left: 530px;
  --btn-restart-top: 550px;
}

html,body{height:100%;margin:0;background:#000;overflow:hidden}
body{display:flex;align-items:center;justify-content:center}

#screen{position:relative;width:var(--screen-width);height:var(--screen-height);box-sizing:border-box;opacity:0;transition:opacity var(--transition-duration) ease}
#screen.visible{opacity:1}

.bg{position:absolute;inset:0;width:100%;height:100%;background-repeat:no-repeat;background-size:cover;background-position:center center;z-index:10;pointer-events:none}
.scene-layer{position:absolute;left:0;top:0;width:100%;height:100%;z-index:20;pointer-events:none}

#bv-vessel{
  /* Ensure vessel artwork occupies the full 1280x720 canvas and aligns
     to the screen. Use object-fit: none to prevent browser scaling. */
  position:absolute;
  left:0;
  top:0;
  transform:none;
  z-index:25;
  width:1280px;
  height:720px;
  max-width:none;
  max-height:none;
  image-rendering:pixelated;
  object-fit: none;
  pointer-events:none;
}

/* 灯り: 画面を覆うように置き、opacity を下げて消していく */
#bv-light{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:24;max-width:120%;height:auto;pointer-events:none;opacity:1;transition:opacity var(--bv-body-fade-out) linear}

[data-ui-text-container]{position:absolute;left:0;top:0;width:100%;height:100%;z-index:40;pointer-events:none;display:flex;align-items:center;justify-content:center}
.ui-text-image{position:relative;left:50%;top:50%;transform:translate(-50%,-50%);max-width:100%;max-height:100%;z-index:40;pointer-events:none;image-rendering:pixelated;display:block;opacity:var(--bv-opacity-start);transition:opacity var(--bv-body-fade-in) ease}

/* タイトル: 画像が 1280x720 の場合はキャンバスに合わせてそのまま表示する */
#bv-title{position:absolute;left:0;top:0;transform:none;z-index:50;pointer-events:none;width:var(--screen-width);height:var(--screen-height);max-width:none;max-height:none;transition:opacity var(--bv-body-fade-in) ease}

.btn-ui{position:absolute;transform:none;pointer-events:auto;user-select:none;-webkit-user-drag:none;width:auto;height:auto;z-index:60;cursor:pointer}
.btn-ui:active{filter:brightness(1.5)}
#btn-next{left:var(--btn-next-left);top:var(--btn-next-top)}
#btn-restart{left:var(--btn-restart-left);top:var(--btn-restart-top)}

.show{opacity: var(--bv-opacity-end); transition: opacity var(--bv-body-fade-in) ease}
.hide{opacity: var(--bv-opacity-start); transition: opacity var(--bv-body-fade-out) ease}

/* タイトル用の高優先度ルール: ID と組み合わせて specificity を上げ、
  #bv-title に対して .show/.hide を確実に適用させます。 */
#bv-title.show{ opacity: var(--bv-opacity-end); transition: opacity var(--bv-body-fade-in) ease }
#bv-title.hide{ opacity: var(--bv-opacity-start); transition: opacity var(--bv-body-fade-out) ease }

.btn-ui.hidden{display:none !important;opacity:0}
.btn-ui.show{display:inline-block;opacity:1;transition:opacity 240ms ease}

@media (max-width:1280px){
  :root{ --screen-fit-w: calc((100vw - 20px) / 1280); --screen-fit-h: calc((100vh - 20px) / 720) }
  #screen{ width:1280px; height:720px; transform: scale(min(var(--screen-fit-w), var(--screen-fit-h))); transform-origin:center center }
  .bg, .scene-layer{ width:1280px; height:720px }
  .scene-layer img, .btn-ui{ max-width:none; height:auto }
}

.hidden{display:none !important}

/* 最終手段: メディアクエリ内の .scene-layer img ルールが
  タイトル画像の max-width を無効にしている可能性があるため、
  ここで後出しで強制的にタイトルの最大サイズを指定します。 */
/* タイトルは上の #bv-title ルールでフルキャンバス表示するため、
  ここでの別ルールは不要（削除済み）。 */

/* 小学生向けメモ:
   - 灯りはだんだん暗くして、本文画像の表示に合わせて消えるよ。
   - JS は .show / .hide を付け替えてフェードさせます。
*/
